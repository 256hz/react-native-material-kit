<!DOCTYPE html>

<html>
<head>
  <title>Textfield.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>Textfield.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/* eslint react/no-multi-comp:0, react/sort-comp:0 */</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>MDL style textfield component.</p>
<ul>
<li>@see <a href="http://www.getmdl.io/components/index.html#textfields-section">MDL Textfield</a></li>
<li><a href="#props">Props</a></li>
<li><a href="#defaults">Defaults</a></li>
<li><a href="#builders">Built-in builders</a></li>
</ul>
<p>Created by ywu on 15/8/3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">import</span> React, {
  Component,
  PropTypes,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">import</span> {
  Animated,
  TextInput,
  View,
  NativeModules,
  findNodeHandle,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">const</span> UIManager = NativeModules.UIManager;

<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> MKPropTypes <span class="hljs-keyword">from</span> <span class="hljs-string">'../MKPropTypes'</span>;
<span class="hljs-keyword">import</span> MKColor <span class="hljs-keyword">from</span> <span class="hljs-string">'../MKColor'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> utils <span class="hljs-keyword">from</span> <span class="hljs-string">'../utils'</span>;
<span class="hljs-keyword">import</span> { getTheme } <span class="hljs-keyword">from</span> <span class="hljs-string">'../theme'</span>;

<span class="hljs-keyword">import</span> { pick } <span class="hljs-keyword">from</span> <span class="hljs-string">'ramda'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="-section-id-floatinglabel-floatinglabel-section-"><section id='FloatingLabel'>FloatingLabel</section></h2>
<p><code>FloatingLabel</code> component of the <a href="#Textfield"><code>Textfield</code></a>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FloatingLabel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.labelDim = {};
    <span class="hljs-keyword">this</span>.offsetX = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.placeholderHeight = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.state = {
      progress: <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">1</span>),
      opacity: <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">0</span>),
      text: <span class="hljs-string">''</span>,
    };
  }

  componentWillMount() {
    <span class="hljs-keyword">this</span>.updateText(<span class="hljs-keyword">this</span>.props.text);
  }

  componentWillReceiveProps(nextProps) {
    <span class="hljs-keyword">this</span>.updateText(nextProps.text);
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>property initializers begin</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  _onLabelLayout = ({ nativeEvent: { layout } }) =&gt; {
    <span class="hljs-keyword">const</span> x = layout.x;
    <span class="hljs-keyword">const</span> width = layout.width;
    <span class="hljs-keyword">const</span> height = layout.height;

    <span class="hljs-keyword">if</span> (width &amp;&amp; !<span class="hljs-keyword">this</span>.offsetX) {
      <span class="hljs-keyword">this</span>.offsetX = ((width - (width * <span class="hljs-number">0.8</span>)) / <span class="hljs-number">2</span> * <span class="hljs-number">-1</span>) - x;
    }

    <span class="hljs-keyword">if</span> (height &amp;&amp; !<span class="hljs-keyword">this</span>.placeholderHeight) {
      <span class="hljs-keyword">this</span>.placeholderHeight = height;
    }

    <span class="hljs-keyword">if</span> (width !== <span class="hljs-keyword">this</span>.labelDim.width || height !== <span class="hljs-keyword">this</span>.labelDim.height) {
      <span class="hljs-keyword">this</span>.labelDim = { width, height };
    }
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>property initializers end</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  updateText(text) {
    <span class="hljs-keyword">this</span>.setState({ text });
  }

  measure(cb) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refs.label &amp;&amp; UIManager.measure(findNodeHandle(<span class="hljs-keyword">this</span>.refs.label), cb);
  }

  aniFloatLabel() {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {
      <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-keyword">return</span> [Animated.sequence([
      Animated.timing(<span class="hljs-keyword">this</span>.state.opacity, {
        toValue: <span class="hljs-number">1</span>,
        duration: <span class="hljs-keyword">this</span>.props.opacityAniDur,
      }),
      Animated.timing(<span class="hljs-keyword">this</span>.state.progress, {
        toValue: <span class="hljs-number">0</span>,
        duration: <span class="hljs-keyword">this</span>.props.floatingLabelAniDuration,
      }),
    ])];
  }

  aniSinkLabel() {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {
      <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-keyword">return</span> [Animated.sequence([
      Animated.timing(<span class="hljs-keyword">this</span>.state.progress, {
        toValue: <span class="hljs-number">1</span>,
        duration: <span class="hljs-keyword">this</span>.props.floatingLabelAniDuration,
      }),
      Animated.timing(<span class="hljs-keyword">this</span>.state.opacity, {
        toValue: <span class="hljs-number">0</span>,
        duration: <span class="hljs-keyword">this</span>.props.opacityAniDur,
      }),
    ])];
  }

  render() {
    <span class="hljs-keyword">const</span> labelColor = <span class="hljs-keyword">this</span>.state.progress.interpolate({
      inputRange: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
      outputRange: [<span class="hljs-keyword">this</span>.props.highlightColor, <span class="hljs-keyword">this</span>.props.tintColor],
    });

    <span class="hljs-keyword">const</span> labelScale = <span class="hljs-keyword">this</span>.state.progress.interpolate({
      inputRange: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
      outputRange: [<span class="hljs-number">0.8</span>, <span class="hljs-number">1</span>],
    });

    <span class="hljs-keyword">const</span> labelY = <span class="hljs-keyword">this</span>.state.progress.interpolate({
      inputRange: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
      outputRange: [<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.placeholderHeight],
    });

    <span class="hljs-keyword">const</span> labelX = <span class="hljs-keyword">this</span>.state.progress.interpolate({
      inputRange: [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>],
      outputRange: [<span class="hljs-keyword">this</span>.offsetX, <span class="hljs-number">0</span>],
    });

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Animated.Text</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">"label"</span>
        <span class="hljs-attr">pointerEvents</span>=<span class="hljs-string">"none"</span>
        <span class="hljs-attr">allowFontScaling</span>=<span class="hljs-string">{this.props.allowFontScaling}</span>

        <span class="hljs-attr">style</span>=<span class="hljs-string">{[{</span>
          <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">MKColor.Transparent</span>,
          <span class="hljs-attr">position:</span> '<span class="hljs-attr">absolute</span>',
          <span class="hljs-attr">top:</span> <span class="hljs-attr">labelY</span>,
          <span class="hljs-attr">left:</span> <span class="hljs-attr">labelX</span>,
          <span class="hljs-attr">color:</span> <span class="hljs-attr">labelColor</span>,
          <span class="hljs-attr">opacity:</span> <span class="hljs-attr">this.state.opacity</span>,
          <span class="hljs-attr">fontSize:</span> <span class="hljs-attr">16</span>,
          <span class="hljs-attr">transform:</span> [
            { <span class="hljs-attr">scale:</span> <span class="hljs-attr">labelScale</span> },
          ],
          <span class="hljs-attr">marginBottom:</span> <span class="hljs-attr">this.props.floatingLabelBottomMargin</span>,
        },
        <span class="hljs-attr">this.props.floatingLabelFont</span>,
        ]}
        <span class="hljs-attr">onLayout</span>=<span class="hljs-string">{this._onLabelLayout}</span>
      &gt;</span>
        {this.state.text}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Animated.Text</span>&gt;</span>
    );
  }
}

</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="-section-id-floatinglabelprops-floatinglabel-props-section-"><section id='floatingLabelProps'>FloatingLabel Props</section></h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>FloatingLabel.publicPropTypes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Enable floating label effect</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  floatingLabelEnabled: PropTypes.bool,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Duration of floating transition, also affect underline animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  floatingLabelAniDuration: PropTypes.number,</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Spacing between floating label and input text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  floatingLabelBottomMargin: PropTypes.number,</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p><a href="MKPropTypes.html#font">Font</a> of floating label
<strong><i>FIXME</i></strong> causing warning: <code>typeChecker is not a function</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  floatingLabelFont: MKPropTypes.font,</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Specifies should fonts scale to respect Text Size accessibility setting on iOS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  allowFontScaling: PropTypes.bool,
};

FloatingLabel.propTypes = {
  ...FloatingLabel.publicPropTypes,</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>internal props</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tintColor: PropTypes.string,
  highlightColor: PropTypes.string,
  opacityAniDur: PropTypes.number,
};

FloatingLabel.defaultProps = {
  floatingLabelAniDuration: <span class="hljs-number">200</span>,
  opacityAniDur: <span class="hljs-number">0</span>,
};</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2 id="-section-id-underline-underline-section-"><section id='Underline'>Underline</section></h2>
<p><code>Underline</code> component of the <a href="#Textfield"><code>Textfield</code></a>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Underline</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.animatedLeft = <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">this</span>.animatedLineLength = <span class="hljs-keyword">new</span> Animated.Value(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">this</span>.state = {
      lineLength: <span class="hljs-number">0</span>,
    };
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>update the length of stretched underline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  updateLineLength(lineLength, cb) {
    <span class="hljs-keyword">this</span>.setState({ lineLength }, cb);
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>stretch the line, from center</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  aniStretchUnderline(focused) {
    <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>.props.underlineEnabled &amp;&amp; focused)) {
      <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-keyword">this</span>.animatedLeft.setValue(<span class="hljs-keyword">this</span>.state.lineLength / <span class="hljs-number">2</span>);
    <span class="hljs-keyword">return</span> [
      Animated.timing(<span class="hljs-keyword">this</span>.animatedLeft, {
        toValue: <span class="hljs-number">0</span>,
        duration: <span class="hljs-keyword">this</span>.props.underlineAniDur,
      }),
      Animated.timing(<span class="hljs-keyword">this</span>.animatedLineLength, {
        toValue: <span class="hljs-keyword">this</span>.state.lineLength,
        duration: <span class="hljs-keyword">this</span>.props.underlineAniDur,
      }),
    ];
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>collapse the the line to a single point at center</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  aniShrinkUnderline() {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.props.underlineEnabled) {
      <span class="hljs-keyword">return</span> [];
    }

    <span class="hljs-keyword">return</span> [
      Animated.timing(<span class="hljs-keyword">this</span>.animatedLeft, {
        toValue: <span class="hljs-keyword">this</span>.state.lineLength / <span class="hljs-number">2</span>,
        duration: <span class="hljs-keyword">this</span>.props.underlineAniDur,
      }),
      Animated.timing(<span class="hljs-keyword">this</span>.animatedLineLength, {
        toValue: <span class="hljs-number">0</span>,
        duration: <span class="hljs-keyword">this</span>.props.underlineAniDur,
      }),
    ];
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>the colorful forefront line, animation enabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  renderUnderline() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.underlineEnabled &amp;&amp; (
      &lt;Animated.View
        style={{
          position: 'absolute',
          backgroundColor: this.props.highlightColor,
          height: this.props.underlineSize,
          left: this.animatedLeft,
          width: this.animatedLineLength,
        }}
      /&gt;);
  }

  render() {
    return (
      &lt;View pointerEvents="none"
        style={{</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>top: -this.props.underlineSize,</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          height: <span class="hljs-keyword">this</span>.props.underlineSize,
        }}
      &gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>  // <span class="hljs-attr">the</span> <span class="hljs-attr">default</span> <span class="hljs-attr">silver</span> <span class="hljs-attr">border</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">position:</span> '<span class="hljs-attr">absolute</span>',
            <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">this.props.tintColor</span>,
            <span class="hljs-attr">height:</span> <span class="hljs-attr">this.props.underlineSize</span>,
            <span class="hljs-attr">width:</span> <span class="hljs-attr">this.state.lineLength</span>,
          }}
        /&gt;</span>
        {this.renderUnderline()}
      <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
    );
  }
}

Underline.propTypes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>internal props</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  underlineEnabled: PropTypes.bool,
  tintColor: PropTypes.string,
  highlightColor: PropTypes.string,
  underlineSize: PropTypes.number,
  underlineAniDur: PropTypes.number,
};

Underline.defaultProps = {
  underlineEnabled: <span class="hljs-literal">true</span>,
  underlineAniDur: FloatingLabel.defaultProps.floatingLabelAniDuration,
  underlineSize: <span class="hljs-number">2</span>,
};</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <h2 id="-section-id-textfield-textfield-section-"><section id='Textfield'>Textfield</section></h2>
<p><code>Textfield</code> component,
which has floating label and underline effect.</p>
<ul>
<li><strong><i>TODO</i></strong> styling read-only &amp; diabled mode</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Textfield</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.theme = getTheme();
    <span class="hljs-keyword">this</span>.inputFrame = {};
    <span class="hljs-keyword">this</span>.anim = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.state = {
      inputMarginTop: <span class="hljs-number">0</span>,
    };
  }

  set bufferedValue(v) {
    <span class="hljs-keyword">this</span>._bufferedValue = v;
    <span class="hljs-keyword">if</span> (v) {
      <span class="hljs-keyword">this</span>._aniFloatLabel();
    }
  }

  get bufferedValue() {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>._bufferedValue || <span class="hljs-string">''</span>).trim();
  }

  focus() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refs.input) {
      <span class="hljs-keyword">this</span>.refs.input.focus();
    }
  }

  isFocused() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.refs.input &amp;&amp; <span class="hljs-keyword">this</span>.refs.input.isFocused();
  }

  blur() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refs.input) {
      <span class="hljs-keyword">this</span>.refs.input.blur();
    }
  }

  componentWillMount() {
    <span class="hljs-keyword">this</span>.bufferedValue = <span class="hljs-keyword">this</span>.props.value || <span class="hljs-keyword">this</span>.props.text ||
    <span class="hljs-keyword">this</span>.props.defaultValue;
    <span class="hljs-keyword">this</span>._originPlaceholder = <span class="hljs-keyword">this</span>.props.placeholder;
  }

  componentWillReceiveProps(nextProps) {
    <span class="hljs-keyword">const</span> newText = nextProps.value || nextProps.text || nextProps.defaultValue;
    <span class="hljs-keyword">if</span> (newText) {
      <span class="hljs-keyword">this</span>.bufferedValue = newText;
    }
    <span class="hljs-keyword">this</span>._originPlaceholder = nextProps.placeholder;
  }

  componentDidMount() {
    requestAnimationFrame(<span class="hljs-keyword">this</span>._doMeasurement.bind(<span class="hljs-keyword">this</span>));
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>property initializers begin</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  _onTextChange = (text) =&gt; {
    <span class="hljs-keyword">this</span>.bufferedValue = text;
    <span class="hljs-keyword">this</span>._callback(<span class="hljs-string">'onTextChange'</span>, text);
    <span class="hljs-keyword">this</span>._callback(<span class="hljs-string">'onChangeText'</span>, text);
  };

  _onFocus = (e) =&gt; {
    <span class="hljs-keyword">this</span>._aniStartHighlight(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">this</span>._callback(<span class="hljs-string">'onFocus'</span>, e);
  };

  _onBlur = (e) =&gt; {
    <span class="hljs-keyword">this</span>._aniStopHighlight();
    <span class="hljs-keyword">this</span>._callback(<span class="hljs-string">'onBlur'</span>, e);
  };</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>property initializers end</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
  startAnimations(animations, cb) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.anim) {
      <span class="hljs-keyword">this</span>.anim.stop();
    }

    <span class="hljs-keyword">this</span>.anim = Animated.parallel(animations).start(cb);
  }

  _doMeasurement() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refs.input) {
      <span class="hljs-keyword">this</span>.refs.input.measure(<span class="hljs-keyword">this</span>._onInputMeasured.bind(<span class="hljs-keyword">this</span>));
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {
        <span class="hljs-keyword">this</span>.refs.floatingLabel.measure(<span class="hljs-keyword">this</span>._onLabelMeasured.bind(<span class="hljs-keyword">this</span>));
      }
    }
  }

  _onLabelMeasured(left, top, width, height) {
    <span class="hljs-keyword">this</span>.setState({ inputMarginTop: height });
  }

  _onInputMeasured(left, top, width, height) {
    <span class="hljs-built_in">Object</span>.assign(<span class="hljs-keyword">this</span>.inputFrame, { left, top, width, height });
    <span class="hljs-keyword">this</span>.refs.underline.updateLineLength(width, () =&gt; {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bufferedValue || <span class="hljs-keyword">this</span>.isFocused()) {
        <span class="hljs-keyword">this</span>._aniStartHighlight(<span class="hljs-keyword">this</span>.isFocused());  <span class="hljs-comment">// if input not empty, lift the label</span>
      }
    });
  }

  _aniFloatLabel() {
    <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span>.bufferedValue &amp;&amp; <span class="hljs-keyword">this</span>.props.floatingLabelEnabled)) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refs.floatingLabel) {
      <span class="hljs-keyword">const</span> animations = <span class="hljs-keyword">this</span>.refs.floatingLabel.aniFloatLabel();
      <span class="hljs-keyword">if</span> (animations.length) {
        <span class="hljs-keyword">this</span>.startAnimations(animations);
      }
    }
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>animation when textfield focused</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _aniStartHighlight(focused) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>hide fixed placeholder, if floating</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.setPlaceholder(<span class="hljs-string">''</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>and show floating label
<strong><i>FIXME</i></strong> workaround <a href="https://github.com/facebook/react-native/issues/3220">https://github.com/facebook/react-native/issues/3220</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">this</span>.refs.floatingLabel.updateText(<span class="hljs-keyword">this</span>._originPlaceholder);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>stretch the underline if enabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> animations = <span class="hljs-keyword">this</span>.refs.underline.aniStretchUnderline(focused);</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>and lift the floating label, if enabled</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {
      animations.push(...this.refs.floatingLabel.aniFloatLabel());
    }

    <span class="hljs-keyword">if</span> (animations.length) {
      <span class="hljs-keyword">this</span>.startAnimations(animations);
    }
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>animation when textfield lost focus</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  _aniStopHighlight() {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>shrink the underline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">const</span> animations = <span class="hljs-keyword">this</span>.refs.underline.aniShrinkUnderline();</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>pull down the label, or keep position if input is not empty</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled &amp;&amp; !<span class="hljs-keyword">this</span>.bufferedValue) {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>input is empty, label should be pulled down</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      animations.push(...this.refs.floatingLabel.aniSinkLabel());
    }

    <span class="hljs-keyword">if</span> (animations.length) {
      <span class="hljs-keyword">this</span>.startAnimations(animations, () =&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>then show fixed placeholder</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">this</span>.setPlaceholder(<span class="hljs-keyword">this</span>._originPlaceholder);</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>and hide floating label
<strong><i>FIXME</i></strong> workaround <a href="https://github.com/facebook/react-native/issues/3220">https://github.com/facebook/react-native/issues/3220</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>          <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.bufferedValue) {
            <span class="hljs-keyword">this</span>.refs.floatingLabel.updateText(<span class="hljs-string">''</span>);
          }
        }
      });
    }
  }

  setPlaceholder(placeholder) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refs.input) {
      <span class="hljs-keyword">this</span>.refs.input.setNativeProps({ placeholder });
    }
  }

  _callback(name, e) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props[name]) {
      <span class="hljs-keyword">this</span>.props[name](e);
    }
  }

  render() {
    <span class="hljs-keyword">const</span> tfTheme = <span class="hljs-keyword">this</span>.theme.textfieldStyle;
    <span class="hljs-keyword">let</span> floatingLabel;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.floatingLabelEnabled) {</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>the floating label</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-keyword">const</span> props = <span class="hljs-built_in">Object</span>.assign(
        pick([<span class="hljs-string">'tintColor'</span>, <span class="hljs-string">'highlightColor'</span>, <span class="hljs-string">'floatingLabelFont'</span>], tfTheme),
        utils.extractProps(<span class="hljs-keyword">this</span>, FloatingLabel.propTypes));

      floatingLabel = (
        &lt;FloatingLabel ref="floatingLabel"
          {...props}
          text={this.props.placeholder}
          allowFontScaling={this.props.allowFontScaling}
        /&gt;
      );
    }

    const underlineProps = Object.assign(
      pick(['tintColor', 'highlightColor'], tfTheme),
      utils.extractProps(this, ['tintColor',
        'highlightColor', 'underlineSize', 'underlineEnabled']));
    const inputProps = utils.extractProps(this, {
      ...TextInput.propTypes,
      password: 1,
    });

    return (
      &lt;View style={this.props.style} &gt;
        {floatingLabel}
        &lt;TextInput  // the input
          ref="input"
          {...inputProps}
          style={[{
            backgroundColor: MKColor.Transparent,
            alignSelf: 'stretch',
            paddingTop: 2, paddingBottom: 2,
            marginTop: this.state.inputMarginTop,
          },
          this.theme.textfieldStyle.textInputStyle,
          this.props.textInputStyle,
          ]}
          onChangeText={this._onTextChange}
          onFocus={this._onFocus}
          onBlur={this._onBlur}
          allowFontScaling={this.props.allowFontScaling}
          secureTextEntry={this.props.password}
          underlineColorAndroid="transparent"
        /&gt;
        &lt;Underline ref="underline"  // the underline
          {...underlineProps}
          underlineAniDur={this.props.floatingLabelAniDuration}
        /&gt;
      &lt;/View&gt;
    );
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <h2 id="-section-id-props-props-section-"><section id='props'>Props</section></h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>Textfield.propTypes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p><a href="https://facebook.github.io/react-native/docs/textinput.html#props">TextInput Props</a>…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  ...TextInput.propTypes,</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Alias to <code>value</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  text: PropTypes.string,</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>alias to <code>onChangeText</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  onTextChange: PropTypes.func,</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Alias to <code>secureTextEntry</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  password: PropTypes.bool,</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p><a href="#floatingLabelProps">Floating Label Props</a>…</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  ...FloatingLabel.publicPropTypes,</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>The highlighted bottom border effect</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  underlineEnabled: PropTypes.bool,</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>The thickness of the Underline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  underlineSize: PropTypes.number,</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Color of the highlighted underline, and also the floating label</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  highlightColor: PropTypes.string,</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Color of the un-highlighted underline, and the placeholder</p>
<ul>
<li><strong><i>TODO</i></strong> cursor color is not affected for now
@see <a href="https://github.com/facebook/react-native/issues/1685">https://github.com/facebook/react-native/issues/1685</a></li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>  tintColor: PropTypes.string,</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Style applied to the <code>TextInput</code> component, ok to use <code>StyleSheet</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  textInputStyle: PropTypes.any,</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Specifies should fonts scale to respect Text Size accessibility setting on iOS.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  allowFontScaling: PropTypes.bool,
};</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <h2 id="-section-id-defaults-defaults-section-"><section id='defaults'>Defaults</section></h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>Textfield.defaultProps = {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>tintColor: ‘rgba(0,0,0,.12)’,
highlightColor: getTheme().primaryColor,
floatingLabelFont: {
  fontSize: getTheme().fontSize - 2,
},</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  style: {
    height: <span class="hljs-number">39</span>,
  },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>textInputStyle: {
  color: getTheme().fontColor,
  fontSize: getTheme().fontSize + 2,
  paddingLeft: 0,
  paddingRight: 0,
},</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  underlineEnabled: <span class="hljs-literal">true</span>,
};</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Builder</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> {
  Builder,
} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../builder'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <h2 id="textfield-builder">Textfield builder</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TextfieldBuilder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Builder</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>For compatibility with RN version older than 0.9.0.</p>
<blockquote>
<p>Since <a href="https://github.com/facebook/react-native/releases/tag/v0.9.0-rc">RN v0.9.0</a>, <code>TextInput</code> became a <a href="https://facebook.github.io/react/docs/forms.html#controlled-components">controlled component</a></p>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>  withDefaultValue(defaultValue) {
    <span class="hljs-keyword">const</span> propName = Textfield.propTypes.defaultValue ? <span class="hljs-string">'defaultValue'</span> : <span class="hljs-string">'value'</span>;
    <span class="hljs-keyword">this</span>[propName] = defaultValue;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  mergeStyle() {
    <span class="hljs-keyword">super</span>.mergeStyle();

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.highlightColor) {
      <span class="hljs-keyword">this</span>.highlightColor = <span class="hljs-keyword">this</span>.getThemeColor();
    }
  }

  build() {
    <span class="hljs-keyword">const</span> BuiltTextfield = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Textfield</span> </span>{};
    BuiltTextfield.defaultProps = <span class="hljs-built_in">Object</span>.assign({}, Textfield.defaultProps, <span class="hljs-keyword">this</span>.toProps());
    <span class="hljs-keyword">return</span> BuiltTextfield;
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>define builder method for each prop</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>TextfieldBuilder.defineProps(Textfield.propTypes);</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <hr>

            </div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <h2 id="-section-id-builders-built-in-builders-section-"><section id="builders">Built-in builders</section></h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textfield</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> TextfieldBuilder();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">textfieldWithFloatingLabel</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> textfield().withFloatingLabelEnabled(<span class="hljs-literal">true</span>);
}</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <h2 id="public-interface">Public interface</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">module</span>.exports = Textfield;

Textfield.Builder = TextfieldBuilder;
Textfield.textfield = textfield;
Textfield.textfieldWithFloatingLabel = textfieldWithFloatingLabel;</pre></div></div>
            
        </li>
        
    </ul>
  </div>
<script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-33049696-2', 'auto'); ga('send', 'pageview'); </script></body>
</html>
